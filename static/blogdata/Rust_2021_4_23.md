花了两天把网站用 Rust 重写了。

## 缘由
虽说 C# 很强大，Blazor 的开发也很简单，但是之前的网站存在致命的问题：慢！

编译出来的仍然是 CIL 的二进制文件，使用 `dotnet.wasm` 解释运行。这样的解释器会导致部分浏览器不兼容尚且不论，那几十个 dll 就算压缩过了也要下载半天。巨硬又不愿意提供完全 AOT，进化了两年的结果也只是把 dll 用 gzip 压缩一下，态度属实太差。最后的结果就是网站加载极慢，还有很大概率无法显示，乃至被群嘲。

考虑到巨硬一贯的作风，最后这样的项目也不会有多少人用，搞不好过了两年也要凉。趁早换一个框架为妙。

语言选择方面，我是不想写 JavaScript 或者 TypeScript 的；要是一两年前可能想写 C++，但是现在肯定是选择 Rust 了。语言不错，还有成熟的框架，也有不错的前景，唯一的难度就在完全重写上了。

## 体验
`yew` 的成熟设计消除了很大的移植压力，比如 `html!` 宏，以及成熟的 Callback 与 Fetch 的 API。可以说已有的前端几乎是可以完全搬过来的。

网站功能方面，之前的几个功能都有其历史的意义，现在已经不需要了，因而懒得重写；主题更换与语言更换也砍掉了，因为没什么人看我的网站，而且之前的日语机翻太烂了。只剩下了一些前端与博客的功能，C# 能找到的轮子，Rust 自然也有，而且效果拔群。`wasm-bindgen` 对于语言间交互的设计也比 Blazor 友善。

这一路重写基本上是顺风顺水，没有出很大的问题，只是一开始在异步获取静态文件那里卡了一阵，因为对 `yew` 还不熟悉，不知道轮子已经造好了。这也延续了我对于 Rust 的一贯印象，即只要编译通过，算法正确，就不会出太大的运行错误。

编译出来的二进制非常小，只有 1M 多，相比之前小了太多，而性能还有提升。至于浏览器支持，之前死活不行的 iOS 也能顺利打开了，令人振奋。

## 展望
Rust 是一个非常有潜力的语言，也能充分调动智慧，并有效提高编程能力。

下回要是想写个服务端，也可以考虑用 Rust。
